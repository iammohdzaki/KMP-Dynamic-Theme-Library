<?xml version="1.0" encoding="utf-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="1000" height="560" viewBox="0 0 1000 560">
  <style>
    .box { fill: #ffffff; stroke: #3f51b5; stroke-width: 2; rx: 8; ry: 8; }
    .box-core { fill: #f3f4ff; stroke: #5c6bc0; stroke-width: 2; rx: 12; ry: 12; }
    .label { font-family: Arial, Helvetica, sans-serif; font-size: 14px; fill: #111827; }
    .title { font-weight: bold; font-size: 16px; fill: #0f172a; font-family: Arial, Helvetica, sans-serif; }
    .sub { font-size:12px; fill:#374151; font-family: Arial, Helvetica, sans-serif; }
    .arrow { stroke: #334155; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
  </style>

  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#334155" />
    </marker>
  </defs>

  <!-- Left column -->
  <rect x="40"  y="40"  width="170" height="56" class="box"/>
  <text x="125" y="74" text-anchor="middle" class="label">AppRoot</text>
  <text x="125" y="90" text-anchor="middle" class="sub">(UI Entry)</text>

  <!-- DynamicThemeProvider -->
  <rect x="230" y="40" width="220" height="56" class="box"/>
  <text x="340" y="74" text-anchor="middle" class="label">DynamicThemeProvider</text>
  <text x="340" y="90" text-anchor="middle" class="sub">provides current theme</text>

  <!-- Arrow AppRoot -> Provider -->
  <path class="arrow" d="M210 68 L230 68" />

  <!-- ThemeController -->
  <rect x="500" y="40" width="180" height="56" class="box"/>
  <text x="590" y="74" text-anchor="middle" class="label">ThemeController</text>
  <text x="590" y="90" text-anchor="middle" class="sub">resolves & persists</text>

  <!-- Arrow Provider -> Controller -->
  <path class="arrow" d="M450 68 L500 68" />

  <!-- Right column: Adapter -->
  <rect x="710" y="40" width="200" height="56" class="box"/>
  <text x="810" y="74" text-anchor="middle" class="label">ComposeThemeAdapter</text>
  <text x="810" y="90" text-anchor="middle" class="sub">Material3Adapter → MaterialTheme</text>
  <path class="arrow" d="M680 68 L710 68" />

  <!-- Library Core group -->
  <rect x="420" y="130" width="520" height="260" class="box-core"/>
  <text x="430" y="142" class="title">Library Core</text>

  <!-- ThemeStore -->
  <rect x="450" y="170" width="160" height="48" class="box"/>
  <text x="530" y="200" text-anchor="middle" class="label">ThemeStore</text>
  <text x="530" y="216" text-anchor="middle" class="sub">(persistence)</text>

  <!-- SystemThemeProvider -->
  <rect x="630" y="170" width="160" height="48" class="box"/>
  <text x="710" y="200" text-anchor="middle" class="label">SystemThemeProvider</text>
  <text x="710" y="216" text-anchor="middle" class="sub">(system dark/light)</text>

  <!-- ThemeRegistry -->
  <rect x="810" y="170" width="120" height="48" class="box"/>
  <text x="870" y="200" text-anchor="middle" class="label">ThemeRegistry</text>
  <text x="870" y="216" text-anchor="middle" class="sub">registered themes</text>

  <!-- ThemeFamilies (below registry) -->
  <rect x="810" y="230" width="120" height="48" class="box"/>
  <text x="870" y="260" text-anchor="middle" class="label">ThemeFamilies</text>
  <text x="870" y="276" text-anchor="middle" class="sub">(light + dark)</text>

  <!-- Connect Controller to Store/System/Registry -->
  <path class="arrow" d="M580 96 L580 170" />
  <path class="arrow" d="M580 170 L450 170" />
  <path class="arrow" d="M580 170 L710 170" />
  <path class="arrow" d="M580 170 L850 170" />

  <!-- Controller -> Adapter -->
  <path class="arrow" d="M680 68 L710 68" />

  <!-- Adapter -> MaterialTheme note -->
  <rect x="710" y="230" width="200" height="48" class="box"/>
  <text x="810" y="260" text-anchor="middle" class="label">MaterialTheme</text>
  <text x="810" y="276" text-anchor="middle" class="sub">colors, typography, shapes</text>
  <path class="arrow" d="M810 96 L810 230" />

  <!-- Legend -->
  <g transform="translate(40,240)">
    <text class="sub" x="0" y="0">Diagram:</text>
    <text class="sub" x="0" y="18">• AppRoot → DynamicThemeProvider → ThemeController → (Store / System / Registry)</text>
  </g>
</svg>
